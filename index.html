<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ogbots Dashboard</title>
  <style>
    body { background-color: #1a1d29; color: white; font-family: Arial, sans-serif; margin: 0; padding: 0; }
    .nav { display: flex; justify-content: space-around; flex-wrap: wrap; padding: 10px; border-bottom: 1px solid #fff; cursor: pointer; }
    .nav div:hover { background-color: #333; }
    .nav div.active { border-bottom: 3px solid #ffb800; font-weight: bold; }
    .section { display: none; text-align: center; padding: 50px; }
    .active { display: block; }
    .btn { background-color: #ffb800; color: black; padding: 10px 20px; border: none; cursor: pointer; margin: 10px; font-weight: bold; font-size: 16px; }
    input, select { width: 300px; padding: 10px; margin: 10px auto; display: block; font-size: 16px; border-radius: 5px; border: none; }
    .footer { text-align: center; padding: 20px; font-size: 14px; color: #bbb; }
    a { color: #ffb800; text-decoration: none; }
    #log { margin-top: 20px; color: lightgreen; font-weight: bold; }
    .dashboard-section { margin-top: 30px; border-top: 1px solid #666; padding-top: 20px; }
  </style>
</head>
<body>
  <div class="nav">
    <div id="nav-create" class="active" onclick="showSection('create')">Create Bot</div>
    <div id="nav-token" onclick="showSection('token')">Token</div>
    <div id="nav-connect" onclick="showSection('connect')">Host Bot</div>
    <div id="nav-dashboard" onclick="showSection('dashboard')">Dashboard</div>
  </div>

  <div id="create" class="section active">
    <h1>Welcome to Ogbots!</h1>
    <button class="btn" onclick="showSection('token')">Get Started</button>
  </div>

  <div id="token" class="section">
    <h1>Paste Your Token</h1>
    <input type="text" id="tokenField" placeholder="Paste your token here" />
    <button class="btn" onclick="copyToken()">Copy Token</button>
    <button class="btn" onclick="showSection('connect')">Next Step</button>
  </div>

  <div id="connect" class="section">
    <h1>Connect Your Bot</h1>
    <input type="text" id="connectToken" placeholder="Bot Token" />
    <button class="btn" onclick="connectBot()">Connect Bot</button>
    <div id="log"></div>
  </div>

  <div id="dashboard" class="section">
    <h1>Bot Dashboard</h1>

    <div class="dashboard-section">
      <h2>Command Manager</h2>
      <input type="text" id="commandInput" placeholder="!example" />
      <button class="btn" onclick="addCommand()">Add Command</button>
      <ul id="commandList" style="list-style: none; padding: 0;"></ul>
    </div>

    <div class="dashboard-section">
      <h2>View Logs</h2>
      <button class="btn" onclick="showLogs()">Show Logs</button>
      <div id="logOutput" style="white-space: pre-wrap; margin-top: 10px;"></div>
    </div>

    <div class="dashboard-section">
      <h2>Bot Settings</h2>
      <label>Command Prefix:</label>
      <input type="text" id="prefixSetting" />
      <label>Example Setting:</label>
      <select id="exampleSetting">
        <option value="on">On</option>
        <option value="off">Off</option>
      </select>
      <button class="btn" onclick="saveSettings()">Save Settings</button>
      <div id="settingsSaved" style="color: lightgreen; margin-top: 10px;"></div>
    </div>
  </div>

  <div class="footer">
    You're signed in as @ordinarygamerlyt <a href="#">Logout</a>
  </div>

  <script>
    function showSection(sectionId) {
      document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
      document.getElementById(sectionId).classList.add('active');
      document.querySelectorAll('.nav div').forEach(nav => nav.classList.remove('active'));
      document.getElementById('nav-' + sectionId).classList.add('active');
    }

    function copyToken() {
      const tokenField = document.getElementById('tokenField');
      tokenField.select();
      document.execCommand('copy');
      alert('Token copied!');
    }

    async function connectBot() {
      const token = document.getElementById('connectToken').value.trim();
      const log = document.getElementById('log');

      if (!token) {
        log.textContent = '‚ùå Please enter your bot token.';
        log.style.color = 'red';
        return;
      }

      log.textContent = '‚è≥ Starting bot...';
      log.style.color = 'white';

      try {
        const res = await fetch('/start-bot', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ token })
        });
        const text = await res.text();
        log.style.color = res.ok ? 'lightgreen' : 'red';
        log.textContent = text;

        if (res.ok) {
          await loadDashboardData();
          showSection('dashboard');
        }
      } catch (err) {
        log.textContent = '‚ùå Server error. Try again.';
        log.style.color = 'red';
      }
    }

    async function addCommand() {
      const cmd = document.getElementById('commandInput').value.trim();
      if (!cmd) return;
      await fetch('/api/commands', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ command: cmd })
      });
      document.getElementById('commandInput').value = '';
      await loadCommands();
    }

    async function loadCommands() {
      const res = await fetch('/api/commands');
      const cmds = await res.json();
      const list = document.getElementById('commandList');
      list.innerHTML = '';
      cmds.forEach(cmd => {
        const li = document.createElement('li');
        li.textContent = cmd.command;
        list.appendChild(li);
      });
    }

    async function showLogs() {
      const res = await fetch('/api/logs');
      const logs = await res.json();
      document.getElementById('logOutput').textContent =
        logs.map(log => `üìù ${log.message} (${log.timestamp})`).join('\n');
    }

    async function loadSettings() {
      const res = await fetch('/api/settings');
      const s = await res.json();
      document.getElementById('prefixSetting').value = s.prefix;
      document.getElementById('exampleSetting').value = s.example_setting;
    }

    async function saveSettings() {
      const prefix = document.getElementById('prefixSetting').value;
      const exampleSetting = document.getElementById('exampleSetting').value;
      await fetch('/api/settings', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ prefix, exampleSetting })
      });
      document.getElementById('settingsSaved').textContent = '‚úÖ Settings saved';
    }

    async function loadDashboardData() {
      await Promise.all([loadCommands(), loadSettings()]);
    }
  </script>
</body>
</html>
